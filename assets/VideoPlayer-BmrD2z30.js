import{d as P,r as l,K as W,o as j,aa as A,c as i,ab as V,b as o,g as c,t as D,p as u,Q as N,_ as H}from"./index-SM1jagzl.js";const U={class:"buttons-box",id:"buttonsBox"},L={class:"buttons-box-left"},I={class:"buttons-box-right"},K={class:"bandwidth"},O=P({__name:"VideoPlayer",props:{videoUrl:{type:String,default:""},height:{type:String,default:"400px"},aspectRatio:{type:String,default:"16:9"},hasAudio:{type:Boolean,default:!0},error:{type:String,default:""}},emits:["play","pause","error","fullscreen"],setup(C,{emit:B}){const p=C,f=B,n=l(),a=l(!1),m=l(!0),y=l(!1),b=l(!1),g=l(0),T=l(""),_=l(p.height);let t=null;const v=()=>{if(!n.value)return;const e=n.value;let r=e.parentElement?.clientWidth||0,d=9/16*r;d>e.clientHeight&&(d=e.clientHeight,r=16/9*d),r>0&&d>0&&(e.style.width=r+"px",e.style.height=d+"px",e.style.paddingTop="0")},E=()=>{if(!n.value)return;const e={container:n.value,autoWasm:!0,background:"",controlAutoHide:!1,debug:!1,decoder:"/jessibuca/decoder.js",forceNoOffscreen:!1,hasAudio:p.hasAudio,heartTimeout:5,heartTimeoutReplay:!0,heartTimeoutReplayTimes:3,hiddenAutoPause:!1,hotKey:!0,isFlv:!1,isFullResize:!1,isNotMute:m.value,isResize:!1,keepScreenOn:!0,loadingText:"请稍等, 视频加载中......",loadingTimeout:10,loadingTimeoutReplay:!0,loadingTimeoutReplayTimes:3,openWebglAlignment:!1,operateBtns:{fullscreen:!1,screenshot:!1,play:!1,audio:!1,record:!1},recordType:"mp4",rotate:0,showBandwidth:!1,supportDblclickFullscreen:!1,timeout:10,useMSE:!0,useWCS:!1,useWebFullScreen:!0,videoBuffer:.1,wasmDecodeErrorReplay:!0,wcsUseVideoRender:!0};console.log("Jessibuca -> options: ",e),typeof window<"u"&&window.Jessibuca?(t=new window.Jessibuca(e),S()):console.error("Jessibuca not available")},S=()=>{t&&(t.on("pause",()=>{a.value=!1,f("pause")}),t.on("play",()=>{a.value=!0,b.value=!0,f("play")}),t.on("fullscreen",e=>{y.value=e,f("fullscreen",e)}),t.on("mute",e=>{m.value=!e}),t.on("performance",e=>{let s="卡顿";e===2?s="非常流畅":e===1&&(s="流畅"),T.value=s}),t.on("kBps",e=>{g.value=Math.round(e)}),t.on("error",e=>{console.log("Jessibuca -> error: ",e),f("error",e)}),t.on("timeout",e=>{console.log("Jessibuca -> timeout: ",e)}),t.on("loadingTimeout",e=>{console.log("Jessibuca -> loadingTimeout: ",e)}))},k=()=>{w(p.videoUrl)},w=e=>{console.log("Jessibuca -> url: ",e),t&&x(),E(),t&&(t.on("play",()=>{a.value=!0,b.value=!0}),t.hasLoaded()?t.play(e):t.on("load",()=>{t.play(e)}))},F=()=>{t&&t.pause(),a.value=!1},x=()=>{t&&t.destroy();const e=document.getElementById("buttonsBox");e&&n.value&&n.value.appendChild(e),t=null,a.value=!1},J=()=>{t&&t.screenshot()},R=()=>{t&&t.mute()},z=()=>{t&&t.cancelMute()},h=()=>{const e=M();t&&t.setFullscreen(!e),y.value=!e},M=()=>!!(document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement);return W(()=>p.videoUrl,e=>{e&&N(()=>{w(e)})},{immediate:!0}),j(()=>{if(v(),window.addEventListener("resize",v),typeof window<"u"&&!window.Jessibuca){const e=document.createElement("script");e.src="/jessibuca/jessibuca.js",e.onload=()=>{console.log("Jessibuca loaded successfully")},document.head.appendChild(e)}}),A(()=>{t&&t.destroy(),window.removeEventListener("resize",v)}),(e,s)=>(u(),i("div",{class:"video-player-container",style:V({height:_.value})},[o("div",{ref_key:"container",ref:n,onDblclick:h,style:{width:"100%",height:"100%","background-color":"#000000",margin:"0 auto",position:"relative"}},[s[2]||(s[2]=o("div",{style:{width:"100%","padding-top":"56.25%",position:"relative"}},null,-1)),o("div",U,[o("div",L,[a.value?c("",!0):(u(),i("i",{key:0,class:"play-btn",onClick:k},"▶")),a.value?(u(),i("i",{key:1,class:"pause-btn",onClick:F},"⏸")):c("",!0),o("i",{class:"stop-btn",onClick:x},"⏹"),m.value?(u(),i("i",{key:2,class:"audio-btn",onClick:s[0]||(s[0]=r=>R())},"🔊")):c("",!0),m.value?c("",!0):(u(),i("i",{key:3,class:"mute-btn",onClick:s[1]||(s[1]=r=>z())},"🔇"))]),o("div",I,[o("span",K,D(g.value)+" kb/s",1),o("i",{class:"screenshot-btn",onClick:J},"📷"),o("i",{class:"refresh-btn",onClick:k},"🔄"),y.value?c("",!0):(u(),i("i",{key:0,class:"fullscreen-btn",onClick:h},"⛶")),y.value?(u(),i("i",{key:1,class:"exit-fullscreen-btn",onClick:h},"⛶")):c("",!0)])])],544)],4))}}),Q=H(O,[["__scopeId","data-v-c1c2755c"]]);export{Q as V};
