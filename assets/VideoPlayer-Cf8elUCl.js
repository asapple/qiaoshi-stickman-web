import{d as P,r as l,K as W,o as j,aa as A,c as i,ab as V,b as o,g as c,t as D,p as u,_ as N}from"./index-D8wFoKkw.js";const U={class:"buttons-box",id:"buttonsBox"},H={class:"buttons-box-left"},L={class:"buttons-box-right"},I={class:"bandwidth"},K=P({__name:"VideoPlayer",props:{videoUrl:{type:String,default:""},height:{type:String,default:"400px"},aspectRatio:{type:String,default:"16:9"},hasAudio:{type:Boolean,default:!0},error:{type:String,default:""}},emits:["play","pause","error","fullscreen"],setup(T,{emit:x}){const f=T,p=x,n=l(),a=l(!1),m=l(!0),y=l(!1),b=l(!1),g=l(0),B=l(""),_=l(f.height);let t=null;const v=()=>{if(!n.value)return;const e=n.value;let r=e.parentElement?.clientWidth||0,d=9/16*r;d>e.clientHeight&&(d=e.clientHeight,r=16/9*d),r>0&&d>0&&(e.style.width=r+"px",e.style.height=d+"px",e.style.paddingTop="0")},E=()=>{if(!n.value)return;const e={container:n.value,autoWasm:!0,background:"",controlAutoHide:!1,debug:!1,decoder:"/jessibuca/decoder.js",forceNoOffscreen:!1,hasAudio:f.hasAudio,heartTimeout:15,heartTimeoutReplay:!0,heartTimeoutReplayTimes:5,hiddenAutoPause:!1,hotKey:!0,isFlv:!1,isFullResize:!1,isNotMute:m.value,isResize:!1,keepScreenOn:!0,loadingText:"è§†é¢‘åŠ è½½ä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…...",loadingTimeout:30,loadingTimeoutReplay:!0,loadingTimeoutReplayTimes:5,openWebglAlignment:!1,operateBtns:{fullscreen:!1,screenshot:!1,play:!1,audio:!1,record:!1},recordType:"mp4",rotate:0,showBandwidth:!1,supportDblclickFullscreen:!1,timeout:30,useMSE:!0,useWCS:!1,useWebFullScreen:!0,videoBuffer:.5,wasmDecodeErrorReplay:!0,wcsUseVideoRender:!0};console.log("Jessibuca -> options: ",e),typeof window<"u"&&window.Jessibuca?(t=new window.Jessibuca(e),S()):console.error("Jessibuca not available")},S=()=>{t&&(t.on("pause",()=>{a.value=!1,p("pause")}),t.on("play",()=>{a.value=!0,b.value=!0,p("play")}),t.on("fullscreen",e=>{y.value=e,p("fullscreen",e)}),t.on("mute",e=>{m.value=!e}),t.on("performance",e=>{let s="å¡é¡¿";e===2?s="éžå¸¸æµç•…":e===1&&(s="æµç•…"),B.value=s}),t.on("kBps",e=>{g.value=Math.round(e)}),t.on("error",e=>{console.log("Jessibuca -> error: ",e),p("error",e)}),t.on("timeout",e=>{console.log("Jessibuca -> timeout: ",e)}),t.on("loadingTimeout",e=>{console.log("Jessibuca -> loadingTimeout: ",e)}))},k=()=>{w(f.videoUrl)},w=e=>{if(console.log("Jessibuca -> url: ",e),!e){console.log("è§†é¢‘URLä¸ºç©ºï¼Œè·³è¿‡æ’­æ”¾");return}t&&C(),E(),t&&(t.on("play",()=>{a.value=!0,b.value=!0}),setTimeout(()=>{t.hasLoaded()?t.play(e):t.on("load",()=>{t.play(e)})},1e3))},F=()=>{t&&t.pause(),a.value=!1},C=()=>{t&&t.destroy();const e=document.getElementById("buttonsBox");e&&n.value&&n.value.appendChild(e),t=null,a.value=!1},J=()=>{t&&t.screenshot()},R=()=>{t&&t.mute()},z=()=>{t&&t.cancelMute()},h=()=>{const e=M();t&&t.setFullscreen(!e),y.value=!e},M=()=>!!(document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement);return W(()=>f.videoUrl,e=>{e&&setTimeout(()=>{w(e)},3e3)},{immediate:!0}),j(()=>{if(v(),window.addEventListener("resize",v),typeof window<"u"&&!window.Jessibuca){const e=document.createElement("script");e.src="/jessibuca/jessibuca.js",e.onload=()=>{console.log("Jessibuca loaded successfully")},document.head.appendChild(e)}}),A(()=>{t&&t.destroy(),window.removeEventListener("resize",v)}),(e,s)=>(u(),i("div",{class:"video-player-container",style:V({height:_.value})},[o("div",{ref_key:"container",ref:n,onDblclick:h,style:{width:"100%",height:"100%","background-color":"#000000",margin:"0 auto",position:"relative"}},[s[2]||(s[2]=o("div",{style:{width:"100%","padding-top":"56.25%",position:"relative"}},null,-1)),o("div",U,[o("div",H,[a.value?c("",!0):(u(),i("i",{key:0,class:"play-btn",onClick:k},"â–¶")),a.value?(u(),i("i",{key:1,class:"pause-btn",onClick:F},"â¸")):c("",!0),o("i",{class:"stop-btn",onClick:C},"â¹"),m.value?(u(),i("i",{key:2,class:"audio-btn",onClick:s[0]||(s[0]=r=>R())},"ðŸ”Š")):c("",!0),m.value?c("",!0):(u(),i("i",{key:3,class:"mute-btn",onClick:s[1]||(s[1]=r=>z())},"ðŸ”‡"))]),o("div",L,[o("span",I,D(g.value)+" kb/s",1),o("i",{class:"screenshot-btn",onClick:J},"ðŸ“·"),o("i",{class:"refresh-btn",onClick:k},"ðŸ”„"),y.value?c("",!0):(u(),i("i",{key:0,class:"fullscreen-btn",onClick:h},"â›¶")),y.value?(u(),i("i",{key:1,class:"exit-fullscreen-btn",onClick:h},"â›¶")):c("",!0)])])],544)],4))}}),$=N(K,[["__scopeId","data-v-a0d4ea6a"]]);export{$ as V};
