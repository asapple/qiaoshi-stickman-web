import{d as M,l as G,m as N,p as se,q as ne,a as l,s as F,L as re,v as te,x as K,y as X,r as m,z as de,A as ue,C as ce,D as ve,E as me,G as fe,H as A,J as Y,K as pe,M as he,O as Z,I as S,Q as ge,c as _,n as we,b as o,o as h,_ as ae,R as ye,u as d,N as _e,w as y,P as j,F as H,e as O,f as E,S as be,g as D,U as T,t as x,i as R,k as Pe}from"./index--N4TCes2.js";import{G as ke,a as Ve}from"./index-BoTZSwn_.js";const[Ce,q]=se("switch"),xe={size:N,loading:Boolean,disabled:Boolean,modelValue:G,activeColor:String,inactiveColor:String,activeValue:{type:G,default:!0},inactiveValue:{type:G,default:!1}};var ze=M({name:Ce,props:xe,emits:["change","update:modelValue"],setup(t,{emit:f,slots:v}){const r=()=>t.modelValue===t.activeValue,u=()=>{if(!t.disabled&&!t.loading){const a=r()?t.inactiveValue:t.activeValue;f("update:modelValue",a),f("change",a)}},n=()=>{if(t.loading){const a=r()?t.activeColor:t.inactiveColor;return l(re,{class:q("loading"),color:a},null)}if(v.node)return v.node()};return ne(()=>t.modelValue),()=>{var a;const{size:g,loading:w,disabled:b,activeColor:k,inactiveColor:P}=t,p=r(),L={fontSize:F(g),backgroundColor:p?k:P};return l("div",{role:"switch",class:q({on:p,loading:w,disabled:b}),style:L,tabindex:b?void 0:0,"aria-checked":p,onClick:u},[l("div",{class:q("node")},[n()]),(a=v.background)==null?void 0:a.call(v)])}}});const ee=te(ze),[Le,z]=se("image"),Ne={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:N,height:N,radius:N,lazyLoad:Boolean,iconSize:N,showError:X,errorIcon:K("photo-fail"),iconPrefix:String,showLoading:X,loadingIcon:K("photo"),crossorigin:String,referrerpolicy:String,decoding:String};var Se=M({name:Le,props:Ne,emits:["load","error"],setup(t,{emit:f,slots:v}){const r=m(!1),u=m(!0),n=m(),{$Lazyload:a}=de().proxy,g=ue(()=>{const i={width:F(t.width),height:F(t.height)};return ce(t.radius)&&(i.overflow="hidden",i.borderRadius=F(t.radius)),i});ve(()=>t.src,()=>{r.value=!1,u.value=!0});const w=i=>{u.value&&(u.value=!1,f("load",i))},b=()=>{const i=new Event("load");Object.defineProperty(i,"target",{value:n.value,enumerable:!0}),w(i)},k=i=>{r.value=!0,u.value=!1,f("error",i)},P=(i,V,U)=>U?U():l(S,{name:i,size:t.iconSize,class:V,classPrefix:t.iconPrefix},null),p=()=>{if(u.value&&t.showLoading)return l("div",{class:z("loading")},[P(t.loadingIcon,z("loading-icon"),v.loading)]);if(r.value&&t.showError)return l("div",{class:z("error")},[P(t.errorIcon,z("error-icon"),v.error)])},L=()=>{if(r.value||!t.src)return;const i={alt:t.alt,class:z("img"),decoding:t.decoding,style:{objectFit:t.fit,objectPosition:t.position},crossorigin:t.crossorigin,referrerpolicy:t.referrerpolicy};return t.lazyLoad?pe(l("img",Z({ref:n},i),null),[[he("lazy"),t.src]]):l("img",Z({ref:n,src:t.src,onLoad:w,onError:k},i),null)},I=({el:i})=>{const V=()=>{i===n.value&&u.value&&b()};n.value?V():Y(V)},$=({el:i})=>{i===n.value&&!r.value&&k()};return a&&me&&(a.$on("loaded",I),a.$on("error",$),fe(()=>{a.$off("loaded",I),a.$off("error",$)})),A(()=>{Y(()=>{var i;(i=n.value)!=null&&i.complete&&!t.lazyLoad&&b()})}),()=>{var i;return l("div",{class:z({round:t.round,block:t.block}),style:g.value},[L(),p(),(i=v.default)==null?void 0:i.call(v)])}}});const oe=te(Se),Ie=M({__name:"VideoPlayer",props:{height:{type:String,default:"250px"},aspectRatio:{type:String,default:"16:9"}},setup(t){const f=t,v=m(f.height),r=()=>{if(f.aspectRatio&&f.aspectRatio.includes(":")){const[u,n]=f.aspectRatio.split(":").map(Number),a=document.querySelector(".video-player");if(a){const g=a.clientWidth;v.value=`${g*n/u}px`}}};return A(()=>{r(),window.addEventListener("resize",r)}),ge(()=>{window.removeEventListener("resize",r)}),(u,n)=>(h(),_("div",{class:"video-player",style:we({height:v.value})},n[0]||(n[0]=[o("div",{class:"video-placeholder"},[o("div",{class:"play-icon"},"▶"),o("div",{class:"video-text"},"实时视频播放区域")],-1)]),4))}}),$e=ae(Ie,[["__scopeId","data-v-0fba4730"]]),Ue={class:"device-detail-page"},Be={class:"device-controls-card"},Ee={class:"control-list"},De={class:"control-item"},Re={class:"control-item"},Fe={class:"exception-images"},Me={class:"image-item"},Ge={class:"image-timestamp"},je={class:"password-popup"},He={class:"popup-content"},Oe={class:"popup-footer"},Te={class:"notifier-popup"},qe={class:"popup-header"},Ae={class:"popup-content"},Qe={class:"search-section"},We={class:"search-bar"},Je={class:"notifier-section"},Ke={class:"notifier-info"},Xe={class:"notifier-name"},Ye={class:"notifier-phone"},Ze={key:0,class:"empty-state"},eo={class:"notifier-section"},oo={class:"notifier-info"},so={class:"notifier-name"},to={class:"notifier-phone"},ao={key:0,class:"empty-state"},lo={key:0,class:"image-lightbox"},io={class:"lightbox-info"},no={class:"image-timestamp"},ro=M({__name:"DeviceDetailView",setup(t){const v=ye().params.id||"1",r=m(!1),u=m(!1),n=m(!1),a=m({oldPassword:"",newPassword:"",confirmPassword:""}),g=m(!1),w=m(""),b=m([{id:1,name:"张三",phone:"13800138001",isNotifier:!0},{id:2,name:"李四",phone:"13800138002",isNotifier:!0},{id:3,name:"王五",phone:"13800138003",isNotifier:!1},{id:4,name:"赵六",phone:"13800138004",isNotifier:!1}]),k=m([{id:1,url:"https://picsum.photos/300/200?random=1",timestamp:"2025-08-02 14:30"},{id:2,url:"https://picsum.photos/300/200?random=2",timestamp:"2025-08-02 15:00"},{id:3,url:"https://picsum.photos/300/200?random=3",timestamp:"2025-08-02 15:30"},{id:4,url:"https://picsum.photos/300/200?random=4",timestamp:"2025-08-02 16:00"},{id:5,url:"https://picsum.photos/300/200?random=5",timestamp:"2025-08-02 16:30"},{id:6,url:"https://picsum.photos/300/200?random=6",timestamp:"2025-08-02 17:00"}]),P=m(!1),p=m(null),L=c=>{r.value=c,console.log("火柴人模式状态:",c?"on":"off")},I=c=>{u.value=c,console.log("人像隐去状态:",c?"on":"off"),c&&!r.value&&(r.value=!0)},$=()=>{n.value=!0},i=()=>{if(!a.value.oldPassword){R.show("请输入旧密码");return}if(!a.value.newPassword){R.show("请输入新密码");return}if(a.value.newPassword!==a.value.confirmPassword){R.show("新密码与确认密码不一致");return}console.log("修改密码:",{oldPassword:a.value.oldPassword,newPassword:a.value.newPassword}),R.show("密码修改成功"),a.value.oldPassword="",a.value.newPassword="",a.value.confirmPassword="",n.value=!1},V=()=>{a.value.oldPassword="",a.value.newPassword="",a.value.confirmPassword="",n.value=!1},U=()=>{g.value=!0},B=()=>w.value?b.value.filter(c=>c.name.includes(w.value)||c.phone.includes(w.value)):b.value,Q=c=>{const e=b.value.find(C=>C.id===c);e&&(e.isNotifier=!e.isNotifier)},le=()=>{g.value=!1},ie=c=>{p.value=c,P.value=!0},W=()=>{P.value=!1,p.value=null};return A(()=>{console.log("设备详情页加载，设备ID:",v)}),(c,e)=>{const C=be("van-button");return h(),_("div",Ue,[l(d(_e),{title:"设备详情","left-arrow":"",onClickLeft:e[0]||(e[0]=()=>c.$router.back())}),l($e,{height:"250px"}),o("div",Be,[e[14]||(e[14]=o("h2",{class:"card-title"},"设备管理",-1)),o("div",Ee,[o("div",De,[e[10]||(e[10]=o("span",{class:"control-label"},"火柴人模式",-1)),l(d(ee),{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),size:"20px",onChange:L},null,8,["modelValue"])]),o("div",Re,[e[11]||(e[11]=o("span",{class:"control-label"},"人像隐去",-1)),l(d(ee),{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s),size:"20px",onChange:I},null,8,["modelValue"])]),o("div",{class:"control-item action-item",onClick:$},[e[12]||(e[12]=o("span",{class:"control-label"},"修改密码",-1)),l(d(S),{name:"arrow"})]),o("div",{class:"control-item action-item",onClick:U},[e[13]||(e[13]=o("span",{class:"control-label"},"通知人管理",-1)),l(d(S),{name:"arrow"})])])]),o("div",Fe,[e[15]||(e[15]=o("h2",{class:"section-title"},"异常事件记录",-1)),l(d(ke),{"column-num":2,border:!1,gutter:"10"},{default:y(()=>[(h(!0),_(H,null,O(k.value,s=>(h(),Pe(d(Ve),{key:s.id,onClick:J=>ie(s)},{default:y(()=>[o("div",Me,[l(d(oe),{src:s.url,width:"100%",height:"100px",fit:"cover",radius:"8"},null,8,["src"]),o("div",Ge,x(s.timestamp),1)])]),_:2},1032,["onClick"]))),128))]),_:1})]),l(d(j),{show:n.value,"onUpdate:show":e[6]||(e[6]=s=>n.value=s),position:"bottom",style:{height:"50%"},round:""},{default:y(()=>[o("div",je,[e[18]||(e[18]=o("div",{class:"popup-header"},[o("h2",null,"修改设备密码")],-1)),o("div",He,[l(d(E),{modelValue:a.value.oldPassword,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.oldPassword=s),type:"password",label:"旧密码",placeholder:"请输入旧密码",clearable:""},null,8,["modelValue"]),l(d(E),{modelValue:a.value.newPassword,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.newPassword=s),type:"password",label:"新密码",placeholder:"请输入新密码",clearable:""},null,8,["modelValue"]),l(d(E),{modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.confirmPassword=s),type:"password",label:"确认新密码",placeholder:"请再次输入新密码",clearable:""},null,8,["modelValue"])]),o("div",Oe,[l(C,{block:"",round:"",onClick:V,style:{margin:"0 10px 10px 10px"}},{default:y(()=>e[16]||(e[16]=[D(" 取消 ",-1)])),_:1,__:[16]}),l(C,{type:"primary",block:"",round:"",onClick:i,style:{margin:"0 10px 10px 10px"}},{default:y(()=>e[17]||(e[17]=[D(" 确认 ",-1)])),_:1,__:[17]})])])]),_:1},8,["show"]),l(d(j),{show:g.value,"onUpdate:show":e[8]||(e[8]=s=>g.value=s),position:"bottom",style:{height:"80%"},round:""},{default:y(()=>[o("div",Te,[o("div",qe,[e[19]||(e[19]=o("h2",null,"通知人管理",-1)),l(d(S),{name:"cross",class:"close-icon",onClick:le})]),o("div",Ae,[o("div",Qe,[e[20]||(e[20]=o("h3",null,"搜索联系人",-1)),o("div",We,[l(d(E),{modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=s=>w.value=s),placeholder:"通过昵称或手机号搜索",clearable:""},{"right-icon":y(()=>[l(d(S),{name:"search"})]),_:1},8,["modelValue"])])]),o("div",Je,[e[22]||(e[22]=o("h3",null,"已有通知人",-1)),(h(!0),_(H,null,O(B().filter(s=>s.isNotifier),s=>(h(),_("div",{key:s.id,class:"notifier-item"},[o("div",Ke,[o("div",Xe,x(s.name),1),o("div",Ye,x(s.phone),1)]),l(C,{size:"small",onClick:J=>Q(s.id)},{default:y(()=>e[21]||(e[21]=[D(" 取消通知 ",-1)])),_:2,__:[21]},1032,["onClick"])]))),128)),B().filter(s=>s.isNotifier).length===0?(h(),_("div",Ze," 暂无通知人 ")):T("",!0)]),o("div",eo,[e[24]||(e[24]=o("h3",null,"添加新通知人",-1)),(h(!0),_(H,null,O(B().filter(s=>!s.isNotifier),s=>(h(),_("div",{key:s.id,class:"notifier-item"},[o("div",oo,[o("div",so,x(s.name),1),o("div",to,x(s.phone),1)]),l(C,{type:"primary",size:"small",onClick:J=>Q(s.id)},{default:y(()=>e[23]||(e[23]=[D(" 添加通知 ",-1)])),_:2,__:[23]},1032,["onClick"])]))),128)),B().filter(s=>!s.isNotifier).length===0?(h(),_("div",ao," 暂无其他联系人 ")):T("",!0)])])])]),_:1},8,["show"]),l(d(j),{show:P.value,"onUpdate:show":e[9]||(e[9]=s=>P.value=s),position:"center",style:{width:"90%",height:"80%",maxWidth:"800px"},round:"",closeable:"",onClickCloseIcon:W,onClickOverlay:W},{default:y(()=>[p.value?(h(),_("div",lo,[l(d(oe),{src:p.value.url,fit:"contain",class:"lightbox-image"},null,8,["src"]),o("div",io,[o("div",no,x(p.value.timestamp),1)])])):T("",!0)]),_:1},8,["show"])])}}}),vo=ae(ro,[["__scopeId","data-v-fe42f352"]]);export{vo as default};
